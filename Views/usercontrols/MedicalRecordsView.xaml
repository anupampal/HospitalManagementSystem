<UserControl x:Class="HospitalManagementSystem.Views.UserControls.MedicalRecordsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="1000">

	<!-- Define the missing DataGridStyle resource locally -->
	<UserControl.Resources>
		<Style x:Key="DataGridStyle" TargetType="{x:Type DataGrid}">
			<Setter Property="GridLinesVisibility" Value="Horizontal"/>
			<Setter Property="HorizontalGridLinesBrush" Value="#EAECEE"/>
			<Setter Property="BorderBrush" Value="#BDC3C7"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="RowBackground" Value="White"/>
			<Setter Property="AlternatingRowBackground" Value="#F8F9F9"/>
			<Setter Property="ColumnHeaderStyle">
				<Setter.Value>
					<Style TargetType="{x:Type DataGridColumnHeader}">
						<Setter Property="FontWeight" Value="SemiBold"/>
						<Setter Property="Background" Value="#ECF0F1"/>
						<Setter Property="Foreground" Value="#2C3E50"/>
						<Setter Property="Height" Value="30"/>
						<Setter Property="Padding" Value="5,0"/>
					</Style>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- Define a basic ButtonStyle to ensure Toolbar.ButtonStyleKey resolves (if not defined globally) -->
		<Style x:Key="{x:Static ToolBar.ButtonStyleKey}" TargetType="{x:Type Button}">
			<Setter Property="Padding" Value="8,4"/>
			<Setter Property="Margin" Value="2"/>
			<Setter Property="FontSize" Value="13"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Button}">
						<Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
							<ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Opacity" Value="0.85"/>
				</Trigger>
			</Style.Triggers>
		</Style>

	</UserControl.Resources>

	<Grid Margin="10">
		<Grid.ColumnDefinitions>
			<!-- Column 0: List of Records (READ) -->
			<ColumnDefinition Width="3.5*"/>
			<!-- Column 1: Record Details and CRUD actions -->
			<ColumnDefinition Width="Auto"/>
			<ColumnDefinition Width="2.5*"/>
		</Grid.ColumnDefinitions>

		<!-- Main Title -->
		<TextBlock Text="📂 Medical Records Management"
                   FontSize="24"
                   FontWeight="SemiBold"
                   Foreground="#34495E"
                   Grid.ColumnSpan="3"
                   Margin="0,0,0,10"/>

		<!-- Records List Grid -->
		<StackPanel Grid.Column="0" Margin="0,50,10,0">
			<TextBlock Text="Recent Patient Visits"
                       FontSize="16"
                       FontWeight="Bold"
                       Margin="0,0,0,5"/>

			<DataGrid x:Name="RecordsDataGrid"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      Height="580"
                      Style="{DynamicResource DataGridStyle}"
                      SelectionMode="Single"
                      SelectionChanged="RecordsDataGrid_SelectionChanged"
                      ItemsSource="{Binding RecordsList}">
				<DataGrid.Columns>
					<DataGridTextColumn Header="ID" Binding="{Binding RecordID}" Width="50"/>
					<DataGridTextColumn Header="Patient ID" Binding="{Binding PatientID}" Width="80"/>
					<DataGridTextColumn Header="Visit Date" Binding="{Binding VisitDate, StringFormat='{}{0:yyyy-MM-dd}'}" Width="*"/>
					<DataGridTextColumn Header="Chief Complaint" Binding="{Binding ChiefComplaint}" Width="2*"/>
					<DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="*"/>
				</DataGrid.Columns>
			</DataGrid>
		</StackPanel>

		<!-- Grid Splitter -->
		<GridSplitter Grid.Column="1"
                      Width="5"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Stretch"
                      Background="#E0E0E0"
                      Margin="5,50,5,0"/>


		<!-- Record Details Panel -->
		<ScrollViewer Grid.Column="2" Margin="10,50,0,0" VerticalScrollBarVisibility="Auto">
			<StackPanel>

				<TextBlock Text="Record Details"
                           FontSize="18"
                           FontWeight="Bold"
                           Foreground="#2C3E50"
                           Margin="0,0,0,15"/>

				<!-- Read-Only Fields -->
				<StackPanel Orientation="Horizontal" Margin="0,0,0,10">
					<TextBlock Text="Record ID: " FontWeight="SemiBold" Width="100"/>
					<TextBlock x:Name="RecordIdTextBlock" Text="{Binding RecordID}" Width="150" Foreground="#7F8C8D"/>
				</StackPanel>

				<!-- Identifiers -->
				<TextBlock Text="Patient/Staff IDs" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<Grid Margin="0,0,0,10">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>

					<TextBox x:Name="PatientIdTextBox"
                             Grid.Column="0"
                             Text="{Binding PatientID}"
                             d:Text="P1001"
                             ToolTip="Patient ID"
                             Margin="0,0,5,0"/>

					<TextBox x:Name="StaffIdTextBox"
                             Grid.Column="1"
                             Text="{Binding StaffID}"
                             d:Text="S205"
                             ToolTip="Staff ID (Doctor)"
                             Margin="5,0,0,0"/>
				</Grid>

				<!-- Dates -->
				<TextBlock Text="Visit and Follow-up Dates" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<Grid Margin="0,0,0,10">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>

					<DatePicker x:Name="VisitDatePicker"
                                Grid.Column="0"
                                SelectedDate="{Binding VisitDate}"
                                Margin="0,0,5,0"/>

					<DatePicker x:Name="FollowUpDatePicker"
                                Grid.Column="1"
                                SelectedDate="{Binding FollowUpDate}"
                                ToolTip="Optional Follow-up Date"
                                Margin="5,0,0,0"/>
				</Grid>

				<!-- Vital Signs -->
				<TextBlock Text="Vital Signs" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<TextBox x:Name="VitalSignsTextBox"
                         Text="{Binding VitalSigns}"
                         TextWrapping="Wrap"
                         Height="50"
                         VerticalScrollBarVisibility="Auto"
                         d:Text="BP: 120/80, Temp: 98.6°F, HR: 72 bpm"
                         Margin="0,0,0,10"/>

				<!-- Chief Complaint -->
				<TextBlock Text="Chief Complaint" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<TextBox x:Name="ChiefComplaintTextBox"
                         Text="{Binding ChiefComplaint}"
                         TextWrapping="Wrap"
                         Height="70"
                         VerticalScrollBarVisibility="Auto"
                         d:Text="Severe headache lasting 3 days, non-responsive to OTC pain medication."
                         Margin="0,0,0,10"/>

				<!-- Diagnosis -->
				<TextBlock Text="Diagnosis" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<TextBox x:Name="DiagnosisTextBox"
                         Text="{Binding Diagnosis}"
                         TextWrapping="Wrap"
                         Height="70"
                         VerticalScrollBarVisibility="Auto"
                         d:Text="Tension-type headache, likely stress-related."
                         Margin="0,0,0,10"/>

				<!-- Treatment -->
				<TextBlock Text="Treatment" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<TextBox x:Name="TreatmentTextBox"
                         Text="{Binding Treatment}"
                         TextWrapping="Wrap"
                         Height="70"
                         VerticalScrollBarVisibility="Auto"
                         d:Text="Recommended rest, hydration, and prescribed muscle relaxant."
                         Margin="0,0,0,10"/>

				<!-- Prescription -->
				<TextBlock Text="Prescription" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<TextBox x:Name="PrescriptionTextBox"
                         Text="{Binding Prescription}"
                         TextWrapping="Wrap"
                         Height="70"
                         VerticalScrollBarVisibility="Auto"
                         d:Text="Cyclobenzaprine 5mg (1 tab QHS prn tension), #15."
                         Margin="0,0,0,10"/>

				<!-- Notes -->
				<TextBlock Text="Notes" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<TextBox x:Name="NotesTextBox"
                         Text="{Binding Notes}"
                         TextWrapping="Wrap"
                         Height="100"
                         VerticalScrollBarVisibility="Auto"
                         d:Text="Patient educated on stress reduction techniques and signs of severe headache requiring immediate attention."
                         Margin="0,0,0,10"/>

				<!-- Status -->
				<TextBlock Text="Status" FontWeight="SemiBold" Margin="0,5,0,5"/>
				<ComboBox x:Name="StatusComboBox"
                          SelectedValue="{Binding Status}"
                          Margin="0,0,0,10">
					<ComboBoxItem Content="Open"/>
					<ComboBoxItem Content="Closed"/>
					<ComboBoxItem Content="Pending Review"/>
				</ComboBox>

				<!-- Audit/Metadata (Read-Only) -->
				<GroupBox Header="Audit Information" Margin="0,10,0,10" Padding="10">
					<StackPanel>
						<StackPanel Orientation="Horizontal" Margin="0,0,0,5">
							<TextBlock Text="Created: " FontWeight="Normal" Width="70"/>
							<TextBlock x:Name="CreatedDateTextBlock" Text="{Binding CreatedDate}" Foreground="#7F8C8D"/>
						</StackPanel>
						<StackPanel Orientation="Horizontal" Margin="0,0,0,5">
							<TextBlock Text="Updated: " FontWeight="Normal" Width="70"/>
							<TextBlock x:Name="UpdatedDateTextBlock" Text="{Binding UpdatedDate}" Foreground="#7F8C8D"/>
						</StackPanel>
						<StackPanel Orientation="Horizontal">
							<TextBlock Text="By: " FontWeight="Normal" Width="70"/>
							<TextBlock x:Name="UpdatedByTextBlock" Text="{Binding UpdatedBy}" Foreground="#7F8C8D"/>
						</StackPanel>
					</StackPanel>
				</GroupBox>

				<!-- CRUD Actions -->
				<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">

					<Button Content="➕ New/Clear"
                            x:Name="NewRecordButton"
                            Click="NewRecordButton_Click"
                            Style="{DynamicResource {x:Static ToolBar.ButtonStyleKey}}"
                            Background="#F39C12" Foreground="White"
                            Padding="10,5" Margin="0,0,10,0"/>

					<Button Content="🗑 Delete Record"
                            x:Name="DeleteRecordButton"
                            Click="DeleteRecordButton_Click"
                            Style="{DynamicResource {x:Static ToolBar.ButtonStyleKey}}"
                            Background="#E74C3C" Foreground="White"
                            Padding="10,5" Margin="0,0,10,0"/>

					<Button Content="💾 Save Record"
                            x:Name="SaveRecordButton"
                            Click="SaveRecordButton_Click"
                            Style="{DynamicResource {x:Static ToolBar.ButtonStyleKey}}"
                            Background="#2ECC71" Foreground="White"
                            Padding="15,5"/>
				</StackPanel>

			</StackPanel>
		</ScrollViewer>

	</Grid>
</UserControl>
